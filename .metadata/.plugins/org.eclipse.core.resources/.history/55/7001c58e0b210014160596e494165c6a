package com.tvd.gameview.views;

import org.eclipse.core.resources.IResource;
import org.eclipse.core.resources.IResourceChangeEvent;
import org.eclipse.core.resources.IResourceChangeListener;
import org.eclipse.core.resources.IResourceDelta;
import org.eclipse.ui.part.ViewPart;

import com.tvd.gamview.ext.utils.ProjectUtils;

public class XMLFileChangeListener implements IResourceChangeListener {

	public XMLFileChangeListener(ViewPart viewPart) {
		mViewPart = viewPart;
	}
	
	@Override
	public void resourceChanged(IResourceChangeEvent event) {
		if(event.getSource() != null) {
			System.out.println("XMLFileChangeListener::resourceChanged::source instance of = " + event.getSource().getClass().getName()
					+ ", type = " + event.getType());
			
			IResourceDelta delta = event.getDelta();
			IResource resource = delta.getResource();
			String name = resource.getName();
			System.out.println("XMLFileChangeListener::resourceChanged::name = " + name
					+ " deltakind = " + delta.getKind()
					+ " fullpath = " + resource.getFullPath()
					+ " type = " + resource.getType()
					+ " location = " + resource.getLocation()
					+ " extension = " + resource.getFileExtension());
		}
		if(event.getType() == IResourceChangeEvent.PRE_DELETE) {
			System.out.println("XMLFileChangeListener::resourceChanged::source deleted");
			if(mViewPart instanceof BuildingTreeView) {
				ProjectUtils.checkViewsInProject();
				((BuildingTreeView)mViewPart).update();
			}
		}
	}

	private ViewPart mViewPart;
	
}
